\documentclass[a4paper,12pt]{article}
\usepackage[hidelinks]{hyperref}
\usepackage{graphicx}
\usepackage{float}
\usepackage{caption}
\usepackage{array}
\usepackage{tabu}

%% Title Page 
\begin{document}
\title{\Huge Design Requirements\\ 
	 Project: \\ 
	Cafeteria Management System: Reslove}
\author{
         \underline{T-RISE}\\
          Rendani Dau (13381467) \\
	Elana Kuun (12029522) \\
	Semaka Malapane (13081129) \\
	Antonia Michael (13014171) \\
	Isabel Nel (13070305)}

\date{\today}
 

\maketitle
\break

%% Make table of contents
\tableofcontents
\break

\begin{tabu} to 0.8\textwidth { | X[l] | X[l] | }
 \hline
\textbf{Document Title} & Design Requirements Document \\
 \hline
 \textbf{Document Identification}  & Document 0.0.2 \\
\hline
 \textbf{Author}  & Rendani Dau, Elana Kuun, Semaka Malapane, Antonia Michael, Isabel Nel \\
\hline
\textbf{Version} & 0.0.2 \\
\hline
\textbf{Document Status} & Second Version - added the function templates for the client controllers \\
\hline
\end{tabu}

\begin{table}[h!]
\centering
 \begin{tabular}{||c c c c||} 
 \hline
 \textbf{Version} & \textbf{Date} & \textbf{Summary} & \textbf{Authors} \\ [0.5ex] 
 \hline\hline
 0.0.1 & 29 May 2015 &  First draft contains first two use cases  & Rendani Dau, \\ & & template methods and  & Elana Kuun, \\ & &  declarations& Semaka Malapane, \\ & & & Antonia Michael \\ & & & Isabel Nel, \\ & & & \\
 \hline 
 & & & \\
 0.0.2 & 27 August 2015 &  Second draft adding all the client & Rendani Dau, \\ & & and controllers for & Elana Kuun, \\ & & the updated system & Semaka Malapane, \\ & & &  Antonia Michael \\ & & & Isabel Nel \\   [1ex] 
 \hline  
 \end{tabular}
\end{table}

\pagebreak


%%now begin document

%%---------------------------------  INTRODUCTION -------------------------------------------
\section{Introduction}
This document contains the functional requirements specification, architecture requirements and testing for the Resolve Cafeteria Management System that will be created for Software Engineering (COS 301) at the University of Pretoria 2015, by the group T-RISE. In this document we will thoroughly discuss and layout the project's design requirements to provide a clear view of the system as a whole. An agile method is being followed so the following document focusses on the PlaceOrder and ManageProfile modules.

%% ------------------------------ VISION ------------------------------------------------------
\section{Vision}
The vision of this project is to implement a flexible, pluggable, fully functional software application that will be maintainable, with detailed supporting documentation and an instruction manual for the Cafeteria Management System. This system will assist in managing the cafeteria's inventory/stock, executing orders from the cafeteria, generating bills and sending these to the appropriate parties and facilitating payments for access cards (or the use of unique access card numbers). 

%%---------------------------------- BACKGROUND -----------------------------------------
\section{Background}
As specified in the project proposal document from Resolve - the cafeteria is currently cash only and does not accept bank cards or electronic payments. This makes it inconvenient for employees as they have to carry around cash if they want to purchase anything from the cafeteria. Hence, this is equivalent to purchasing from an external food outlet where they can also pay with their preferred method of payment. The employees have to hence use up fuel and time and lastly this does not bring in the maximum amount of income to the cafeteria, hindering its growth and improvement.\\

Resolve is therefore looking for a means to accept payments from employees for the canteen using their employee access cards or access card numbers, with an amount being deducted from their salary at the end of the month.\\

Resolve proposed the Cafeteria Management System to assist with this problem.
After our first meeting with the client, they brought to our attention that at times the cafeteria does not even have enough stock to provide some of the menu items, thus the managing of inventory or stock will also be part of the system. The system will also predict what inventory/stock needs to be bought for the next week in order to avoid such a problem. At the end of each month, the bill for the month will be sent to either payroll or to the employee. This option is configurable from the user's profile. The employee can also set a spending limit for each month for control purposes. The system will have its own maximum, such that users cannot set a limit that exeeds this. 


%%-------------DESIGN--------------------------------------
\section{Standards and conventions}

\subsection{Design standards}
 The diagrams are designed and created using UML. The main use case of the system is decomposed into components.
 
\section{Authentication}
\subsection{authentication.client.controller}
The authentication controller allows existing users to log in and new users to sign up.
\begin{enumerate}
\item Declaration: \\angular.module('users').controller('AuthenticationController', ['\$scope', '\$http', '\$location', '\$cookies', 'Authentication',
	function(\$scope, \$http, \$location, \$cookies, Authentication)
\item Methods:
	\begin{itemize}
 	\item Sign up \\
	 \$scope.signup = function()\\  \\
 	-Usage\\
	 Method that allows a new user to sign up.
	 \item Sign in\\
  	\$scope.signin = function()\\ \\
	 -Usage\\
 	Method that allows an existing user to sign in.
 \end{itemize}	
\end{enumerate}

\subsection{users.authentication.server.controller}
 The authentication controller allows existing users to log in and new users to sign up. It also creates a new super user or admin if eitehr one does not exist, and it sets the system wide limit to 5000.
\begin{enumerate}
\item Methods:
	\begin{itemize}
	\item Sign up\\ 
  	exports.signUp = function(JsonOBject req, JsonOBject res)\\ \\
  	-Usage\\
  	This method ensures that all the fields neccessary to sign up were completed correctly. It returns an error message if one or 	more of the fields were entered incorrectly, otherwhise it adds the user deatils to the database.
 	 \item Sign in\\
	exports.signin = function(JsonOBject req, JsonOBject res, function next) \\ \\
	-Usage\\
	This method allows an existing user to sign it if the user entered his/her details correctly. It performs a check to see if the user 	id and the passoword is correct. If the details are incorrect an error message is displayed.
	\item Sign out\\
	exports.signout = function(JsonOBject req, JsonOBject res)\\  \\
	-Usage\\
	This method lets a user sign out of the system.
 	 \item Check super user\\ exports.checkSuperUser = function()\\ \\
 	 -Usage\\ 
  This method performs a check to confirm whether there is an existing super user or not. If there is no super user, it creates a super user and admin user, and sets the system wide limit to 5000. If these actions were not completed successfully the method displays an error message. This method also checks whether there is an existing admin user and creates one if there is not currently and admin user. An error message is displayed if this action was not performed successfully.
	\end{itemize}
\end{enumerate} 

\subsection{users.authorization.server.controller.js}
\begin{enumerate}
\item Methods: 
	\begin{itemize}
		\item User by ID // exports.userByID = function(JsonOBject req,JsonOBject res,JsonOBject next, String id)
		\\ \\ Usage: Helper function to find and load specific users
		\item Requires login // exports.requiresLogin = function(JsonOBject req, JsonOBject res, function next) 
		\\ \\ Usage: Function to check if a user has not logged in
		\item Has authorization // exports.hasAuthorization = function(JsonOBject roles)
		\\ \\ Usage: Function to check if a user is authorized to be performing certain tasks for specific roles
	\end{itemize}

\end{enumerate}


\section{Manage Profile} 
%------------------------password server controller--------
\subsection{users.password.server.controller}
 The password controller handles all the functionality that has to do with creating and changing passwords.
\begin{enumerate}
\item Methods:
	\begin{itemize}
	\item Forgot password\\ exports.forgot = function(JsonOBject req, JsonOBject res, function next)\\ \\
  	Usage: \\
  	This method lets a user reset their password if they forgot it. It checks that the given username is in the database and then sends the user an email with a link to a page where they can change their password. It also checks that the user's email is correct and valid, otherwise it gives an error.
	\item Validate reset token\\ exports.validateResetToken = function(JsonOBject req, JsonOBject res) \\ \\
	Usage: \\
	This function checks that the reset token isn't invalid. If it's invalid, it redirects the user to a page telling them the token has expired. Otherwise, it redirects them to the page where they can set a new password.
	\item Reset password\\ exports.reset = function(JsonOBject req, JsonOBject res, function next)\\  \\
	Usage: \\
	This method checks that the user's new password details are correct. If they are, then it resets the password, otherwise it gives an error message.
 	 \item Change password\\ exports.changePassword = function(JsonOBject req, JsonOBject res)\\ \\
 	 Usage\\ 
  	This function is called when the user accesses the change password page. It finds the user in the database and changes the password if the password and confirm password are the same.
	\end{itemize}
\end{enumerate} 

%%superuser client controller----------------------------------------------
\subsection{superuser.client.controller.js}
\begin{enumerate}
\item Declaration: \\ angular.module('users').controller('superuserController', ['\$scope', '\$http', '\$location', '\$window', 'Users', 'Authentication',
	function(\$scope, \$http, \$location, \$window, Users, Authentication)  
\item Methods: 
	\begin{itemize}
		\item Assign roles \\ \$scope.assignRoles = function(Boolean isValid)   \\ \\
		Usage: Superuser can assign cashier, cafeteria manager, finance manager and admin roles
		\item Assign roles admin role \\ \$scope.assignRolesAdminRole = function(Boolean isValid) \\ \\
		Usage: Admin user also has access to the assign roles functionality and serves as a back up superuser
		\item Change employee ID \\ \$scope.changeEmployeeID = function(Boolean isValid)\\ \\
		Usage: The superuser can change the employee ID of the users if the user signed up with the incorrect ID or if the company changes the IDs.
		\item Remove employee \\ \$scope.removeEmployee = function(Boolean isValid)  
		\\ \\ Usage: The superuser is also able to remove users from the system, due to resignation or dismissal for example
		\item Search employee \\ \$scope.searchEmployee = function(Boolean isValid)  
		\\ \\ Usage: This function is used to retrieve employees from the system to be able to change their employe ID or remove them from the system
		\item Search employee ID \\ \$scope.searchEmployeeID = function(int row)  
		\\ \\ Usage: This function is used to retrieve employee IDs 
		\item Set system wide limit \\ \$scope.setSystemWideLimit = function(Boolean isValid)\\ \\ Usage: This is used by the superuser to set the maximum monthly spending limit for all the users of the system.
		 \item Set canteen name \\ \$scope.setCanteenName = function(Boolean isValid) 
		\\ \\ Usage: The canteen name is configurable from the superuser's branding settings page.
		\item Check user \\ \$scope.checkUser = function() 
		\\ \\Usage: This is a security function that checks to make sure that the authorized superuser is accessing the page and if this is not the case, the user will be redirected to the home page
		\item Load employees \\ \$scope.loadEmployees = function() 
		\\ \\Usage: This function is used to dynamically populate the drop down menu for the change employee ID functionality
	\end{itemize}
\end{enumerate} 
%%cashier client controller----------------------------------------------
\subsection{cashier.client.controller.js}
\begin{enumerate}
\item Declaration: \\ angular.module('users').controller('cashierController', ['\$scope', '\$http', '\$stateParams', '\$location', 'Authentication',
	function(\$scope, \$http, \$stateParams, \$location, Authentication) 
\item Methods:
	\begin{itemize}
		\item Get orders \\ \$scope.getOrders = function()
		\\ \\ Usage: Function to obtain the list of orders that an order placed from the menu 
		\item Mark as ready \\ \$scope.markAsReady = function(String username, String orderNumber) 
		\\ \\ Usage: Function that the cashier uses to send a notification to the user notifying the user that their order is ready. The function also changes the status in the model from open to ready.
	\item Mark as collected \\ \$scope.markAsCollected = function(String username, String itemName, String orderNumber) 
	\\ \\ Usage: On the click of the 'Order collected' button on the cashier page, this function will be called. It changes the status of the order in the model from ready/open to closed.
	\item Mark as paid \\ \$scope.markAsPaid = function(String username, String itemName, String orderNumber)  
	\\ \\ Usage: On the click of the 'Paid and collected' button on the cashier page, this function will be called. It changes the status of the order in the model from ready/open to closed.
	\item Check user \\ \$scope.checkUser = function() 
	\\ \\ Usage: This is a security function that checks to make sure that the authorized cashier is accessing the page and if this is not the case, the user will be redirected to the home page
	\end{itemize}	
\end{enumerate}
%%finance client controller----------------------------------------------
\subsection{finance.client.controller.js}
\begin{enumerate}
\item Declaration: angular.module('users').controller('FinanceController', ['\$scope', '\$http', '\$location', '\$stateParams', 'Authentication',
    function(\$scope, \$http, \$location, \$stateParams, Authentication)  
\item Methods:
	\begin{itemize}
		\item  Get user orders \\  \$scope.getUserOrders = function() 
		\\ \\ Usage: Function to obtain the orders placed by the users via adding to plate from the menu page and proceeding to place that order. The finance manager will enter the employee ID of the user in the textbox displayed on the page and the orders placed by that user will be displayed on that page.
		\item Check user \\ \$scope.checkUser = function() 
	\\ \\ Usage: This is a security function that checks to make sure that the authorized cashier is accessing the page and if this is not the case, the user will be redirected to the home page
	\end{itemize}	
\end{enumerate}

\subsection{users.profile.server.controller}
 The profile controller provides fuctionality to search for an employee, retrieve the system limit, and for a user to update his/her password.
 \begin{enumerate}
 \item Methods:
 	\begin{itemize}
 		\item Update\\ 
 		exports.update = function(JsonObject req, JsonObject res)\\ \\ 
 		-Usage\\
 		This method allows a user to update his/her profile and displays an error message if the profile could not be updated. 
 		\item Get system limit\\ 
 		exports.getSystemLimit = function(JsonObject req, JsonObject res)\\ \\
 		-Usage\\
		 This method retrieves the system limit, it is used to prevent an employee from setting their limit too high.
 		\item Search employee\\
 		exports.searchEmployee=function(JsonObject req, JsonObject res)\\ \\ 
 		-Usage\\
		 This method allows an employee to be searched. It returns the emplyee details if that employee is found, if the employee is not found it displays an error message.
 	\end{itemize}
 \end{enumerate}
\subsection{settings.client.controller}
 The settings controller allows the user to view and edit profile information. The controller also perfomrs security checks to make sure that unauthorised users cannot access certain functions of the system.
 \begin{enumerate}
 \item Declaration:\\angular.module('users').controller('SettingsController', ['\$scope', '\$http', '\$location', 'Users', 'Authentication',
	function(\$scope, \$http, \$location, Users, Authentication) 
	\item Methods:\\
	\begin{itemize}
	\item Update user profile\\ 
 \$scope.updateUserProfile = function(Boolean isValid) \\ \\
 -Usage\\
 This method allows the user to update profile information. It displays an error if any of the information entered by the user is not in the correct format, or if the limit set by the user exceeds the system limit. 
\item Change user password\\
 \$scope.chageUserPassword = function()\\ \\ 
-Usage\\
This method lets the user change his/her password.

\item Get system limit\\
 \$scope.getSystemLimit = function()\\ \\
-Usage\\
This method retrieves the system wide limit.

\item Search employee\\ 
 \$scope.searchEmployee = function(Boolean isValid)\\  \\
-Usage\\
This method allows the superuser to search for an employee, for example when a new role needs to be assigned to the employee.
This method is also used in finance where an employee is searched to display his/her bill. 

\item Check user role\\
 \$scope.checkuser = function()\\ \\
-Usage\\
This method performs an authentication check to ensure that unauthorised users cannot access certain features. For example, a normal user will not be able to navigate to the manage cafeteria page.

\item Check if the user has a financial role\\
 \$scope.checkFinUser = function()\\ \\
-Usage\\
The checkFinUser method performs a check to establish wheter the user has a finance role or not. It prevents unauthorised users from performing actions that can only be done by users with a finance role.
	\end{itemize}
 \end{enumerate}
 \subsection{password.client.controller}
 The password controller allows a user to reset his/her passoword if they forgot what their password is. 
 \begin{enumerate}
 \item Declaration:\\angular.module('users').controller('PasswordController', ['\$scope', '\$stateParams', '\$http', '\$location', 'Authentication',
	function(\$scope, \$stateParams, \$http, \$location, Authentication) 
	\item Methods:
	\begin{itemize}
	\item Forgot password\\ 
 exports.forgot = function(JsonObject req, JsonObject res, function next)\\ \\
 -Usage\\
 This method sends a link to the user who forgot his/her password that they can follow to reset the password. This link is sent to the user's email account. It displays an error message if the user could not be found, if the user id field is blank, or if an email could not be sent.
 \item Validate reset token\\
 exports.validateResetToken = function(JsonObject req, JsonObject res)\\ \\
 -Usage\\
 The method validates that the user can reset his/her password with the link they followed. If the link is invalid it displays an error message.\\
 \item Reset\\
 exports.reset = function(JsonObject req, JsonObject res, function next)\\ \\
 -Usage\\
 This method resets the user password if the link followed to reset his/her password is valid. It displays an error message if the user did not enter the same password twice or if the password reset token is invalid. If the password has been changed an email is sent to the user to notify him/her of the change.
 \item Change password\\
 exports.changePassword = function(JsonObject req, JsonObject res)\\  \\
 -Usage\\
 This method allows the user to change his/her password. It displays an error message if the user could not be found or is not logged in, if the user did not enter the current password correctly, if the new password is not long enough, or if the user did not enter the same new password twice in order to confirm the new password.
	\end{itemize}
 \end{enumerate}

\section{Manage System}
%%superuser client controller----------------------------------------------
\subsection{superuser.client.controller.js}
\begin{enumerate}
\item Declaration: \\ angular.module('users').controller('superuserController', ['\$scope', '\$http', '\$location', '\$window', 'Users', 'Authentication',
	function(\$scope, \$http, \$location, \$window, Users, Authentication) 
\item Methods: 
	\begin{itemize}
		\item Assign roles \\ \$scope.assignRoles = function(Boolean isValid)  \\ \\
		Usage: Superuser can assign cashier, cafeteria manager, finance manager and admin roles
		\item Assign roles admin role \\ \$scope.assignRolesAdminRole = function(Boolean isValid)   \\ \\
		Usage: Admin user also has access to the assign roles functionality and serves as a back up superuser
		\item Change employee ID \\ \$scope.changeEmployeeID = function(Boolean isValid)  \\ \\
		Usage: The superuser can change the employee ID of the users if the user signed up with the incorrect ID or if the company changes the IDs.
		\item Remove employee \\ \$scope.removeEmployee = function(Boolean isValid)  
		\\ \\ Usage: The superuser is also able to remove users from the system, due to resignation or dismissal for example
		\item Search employee \\ \$scope.searchEmployee = function(Boolean isValid) 
		\\ \\ Usage: This function is used to retrieve employees from the system to be able to change their employe ID or remove them from the system
		\item Search employee ID \\ \$scope.searchEmployeeID = function(row) 
		\\ \\ Usage: This function is used to retrieve employee IDs 
		\item Set system wide limit \\ \$scope.setSystemWideLimit = function(Boolean isValid)  \\ \\ Usage: This is used by the superuser to set the maximum monthly spending limit for all the users of the system.
		 \item Set canteen name \\ \$scope.setCanteenName = function(Boolean isValid) 
		\\ \\ Usage: The canteen name is configurable from the superuser's branding settings page.
		\item Check user \\ \$scope.checkUser = function() 
		\\ \\Usage: This is a security function that checks to make sure that the authorized superuser is accessing the page and if this is not the case, the user will be redirected to the home page
		\item Load employees \\ \$scope.loadEmployees = function() 
		\\ \\Usage: This function is used to dynamically populate the drop down menu for the change employee ID functionality
	\end{itemize}
\end{enumerate}

\subsection{users.superuser.server.controller.js}
\begin{enumerate}
\item Methods:
	\begin{itemize}
		\item Assign roles \\ exports.assignRoles = function(JsonObject req, JsonObject res) 
		\\ \\ Usage: Superuser can assign cashier, cafeteria manager, finance manager and admin roles. It also changes the role of the users in the database/model. 
		\item Assign roles admin role \\ exports.assignRolesAdminRole = function(JsonObject req, JsonObject res) 
		\\ \\ Usage: Admin user also has access to the assign roles functionality and serves as a back up superuser. It also changes the role of the users in the database/model.
		\item Change employee ID \\ exports.changeEmployeeID = function(JsonObject req, JsonObject res)  
		\\ \\ Usage: The superuser can change the employee ID of the users if the user signed up with the incorrect ID or if the company changes the IDs. This changes the employee ID of the user and saves the nnew one in the database.
		\item Remove Employee \\ exports.removeEmployee = function(JsonObject req, JsonObject res)  
		\\ \\ Usage: The superuser is also able to remove users from the system, due to resignation or dismissal for example. The employee is then also removed from the database.	
		\item Send email \\ function sendEmail(newLimit)  
		\\ \\ Usage: This is a helper function to mail all users of the system. It takes the new limit as a parameter and tells the users what the new limit is in the email.
		\item Set system wide limit \\ exports.setSystemWideLimit = function(JsonObject req, JsonObject res) 
		\\ \\ Usage: The superuser is able to change the monthly spending limit of the system here and it will save this value to the database. 
		\item Set canteen name \\ exports.setCanteenName = function(JsonObject req,JsonObject res)
		\\ \\ Usage: The superuser is able to change the canteen name of the system and this is then stored in the database.
		\item Upload Image \\ exports.uploadImage = function(JsonObject req,JsonObject res) \\ \\
		Usage: The superuser can update the cover image on the home page
		\item Load employees \\ exports.loadEmployees = function(JsonObject req,JsonObject res)
		\\ \\ Usage: Employees are loaded from the database for use in other functions
	\end{itemize}
\end{enumerate}

\section{Manage Cafeteria}
%---------------------------menu items server controller-------------------------------------------------------------
\subsection{menuItems.server.controller}
 The menuItems controller handles all the functionality for creating and removing menu items. It also deals with allocating ingredients (inventory items) to the menu items.
\begin{enumerate}
\item Methods:
	\begin{itemize}
	\item Search for inventory items\\ exports.inventoryItems = function(JsonOBject req, JsonOBject res)\\ \\
  	Usage: \\
  	This function is used to find inventory items that can be used as ingredients used to create menu items.
	
	\item Load menu items\\ exports.loadMenuItems = function(JsonOBject req, JsonOBject res) \\ \\
	Usage: \\
	This function is used to get menu items from the database and display them on the menu page.
	\item Load menu categories\\ exports.loadMenuCategories = function(JsonOBject req, JsonOBject res)\\  \\
	Usage: \\
	This is used to load the menu categories. This is used for making the different menu item pages. 
	\item Create menu items\\ exports.createMenuItem = function(JsonOBject req, JsonOBject res)\\ \\
 	 Usage\\ 
  	This function is used to create a new menu item. If the menu item already exists, it gives an error message, otherwise, it creates the menu item. It stores all the details of the menu item in the database.
	\item Create menu category\\ exports.createMenuCategory = function(JsonOBject req, JsonOBject res)\\ \\
 	 Usage\\ 
  	This is used to create categories dynamically. It checks whether a category with the same name exists, if it does, it gives an error message, otherwise, it creates the category.
	\item Read menu items\\ exports.read = function(JsonOBject req, JsonOBject res)\\ \\
 	 Usage\\ 
  	This function shows the current menu item.
	\item Update menu items\\ exports.updateMenuItem = function(JsonOBject req, JsonOBject res)\\ \\
 	 Usage\\ 
  	This function is used to update an existing menu item. It changes the updated details of the menu item in the database.
	\item Update\\ exports.update = function(JsonOBject req, JsonOBject res)\\ \\
 	 Usage\\ 
  	This is a helper function for updateMenuItem. It is used in updateMenuItem to save the changes in the database.
	\item Delete menu items\\ exports.deleteMenuItem = function(JsonOBject req, JsonOBject res)\\ \\
 	 Usage\\ 
  	This function is used to delete an existing menu item. It gives an error message if the item wasn't deleted, otherwise, it removes the item from the updated details of the menu item in the database.
	\item Delete \\ exports.update = function(JsonOBject req, JsonOBject res)\\ \\
 	 Usage\\ 
  	This is a helper function for deleteMenuItem. It is used in deleteMenuItem to remove the item from the database.
	\item List \\ exports.list = function(JsonOBject req, JsonOBject res)\\ \\
 	 Usage\\ 
  	This function is used to display a list of all the menuitems, otherwise, it gives an error message.
	\item Order by ID\\ exports.orderByID = function(JsonOBject req, JsonOBject res, function next, String id)\\ \\
 	 Usage\\ 
  	This is a menu item middleware. It is used to find the menu items by their ID's and it loops through the database to find all the menu items.
	\item Has authortization\\ exports.hasAuthorization = function(JsonOBject req, JsonOBject res, function next)\\ \\
 	 Usage\\ 
  	This is a menuitem authorization middleware. It checks whether the user is authorised to change items, otherwise, it gives an error message.
	\item Search menu \\ exports.searchMenu = function(JsonOBject req, JsonOBject res)\\ \\
 	 Usage\\ 
  	This function is used to search for a given menu item. If the item is not found, an error message is given. If the item is found, its details are returned and it can be updated or deleted from the database.
	\end{itemize}
\end{enumerate}

%--------------------------------------menu items client controller--------------------------
\subsection{menuitems.client.controller}
The menuitems client controller handles all the functionality concerning the menu, such as adding and updating menu items.
\begin{enumerate}
\item Declaration: \\angular.module('menuItems').controller('MenuItemsController', ['\$scope', '\$rootScope','\$http', '\$stateParams', '\$location', '\$cookies', 'Authentication', 'MenuItems',
	function(\$scope, \$rootScope, \$http, \$stateParams, \$location, \$cookies, Authentication, MenuItems)
	
\item Methods:
	\begin{itemize}
		\item Toggle Collapsible Menu\\
		\$scope.toggleCollapsibleMenu = function()\\
		-Usage\\ \\
		This method collapses and opens the Menu Bar. The function is invoked on the click of a button in the HTML file.
		\item Add Form Field\\
		\$scope.addFormField = function()\\
		-Usage\\ \\
		This method adds new text-boxes to assist with adding ingredients for menu items. The method is invoked when the button addIngridients is clicked in the HTML.
		\item Load Ingridients\\
		\$scope.loadIngredients = function()\\
		-Usage\\ \\
		This method transfers ingredients from the request result array to the working scope array. The method is invoked by other methods in the controller.
		\item Add More Ingridients Update\\
		\$scope.addMoreIngredientsUpdate = function()\\
		-Usage\\ \\
		This method adds new text-boxes to assist with updating ingredients for existing menu items. The method is invoked when the button addIngridients is clicked in the update ingredients section in the HTML.
		\item Remove Ingridient\\
		\$scope.removeIngredient = function(int index)\\
		-Usage\\ \\
		This method removes the ingredient at the specified index for the menu item being updated.
		\item Undo Remove Ingredient\\
		\$scope.undoRemoveIngredient = function(index)\\
		-Usage\\ \\
		This method undo's a remove ingredient operation performed by the above function.
		\item Update Menu Itemp\\
		\$scope.updateMenuItem = function()\\
		-Usage\\ \\
		This method sends the update request to the server to update the menu items. It will perform all error checks and display any errors returned from the server in the HTML.
		\item Search Menu\\
		\$scope.searchMenu = function(Boolean isValid)\\
		-Usage\\ \\
		This method searches for a menu item in the database. The search query is obtained from the scope variable.
		\item Create menu item\\
		\$scope.createMenuItem = function(Boolean isValid)\\
		-Usage\\ \\
		This method creates a new menu item in the database. The method will perform all error checks and validation and send the request to the server. The server response will then be displayed on the page.
		\item Create Menu Category\\
		\$scope.createMenuCatagory = function(Boolean isValid)\\
		-Usage\\ \\
		This method adds a new Menu item category to the database. The method will perform error checks and send the request to the server. The server response will be displayed on the page.
		\item Remove Ingredient\\
		\$scope.removeIngredientOption = function(int index)
		-Usage\\ \\
		Removes ingredients from the  new menu item being added. Method is invoked on button click.
		\item Load Menu Items\\
		\$scope.loadMenuItems = function()
		-Usage\\ \\
		This method gets all the menu items from the server and populates the local array. If the server responds with an error, the error will be displayed on the page.
		\item Load Menu Categories\\
		\$scope.loadMenuCategories = function()\\
		-Usage\\ \\
		This method gets all the menu item categories from the server. If the server responds with an error, the error wil be displayed on the page.
		\item Check Stock\\
		\$scope.checkStock = function(String menuItemName)\\
		-Usage\\ \\
		This method checks if all the ingredients required to make a menu item are in stock and the quantities are enough. The item will then be marked appropriately as in-stock or out-of-stock.
		\item Delete Menu Item\\
		\$scope.deleteMenuItem = function(String menuItemName)\\
		-Usage\\ \\
		This method checks deletes the specified menu item from the database. It sends the delete request to the server and will display the servers response in HMTL page.
		\item Add To Plate\\
		\$scope.addToPlate = function(String itemName)\\
		-Usage\\ \\
		This method adds the specified item to the plate, which uses the browsers cookies. The method will check for duplicates and react accordingly when adding
		\item Index of Item\\
		var indexOfItem = function(JsonObj[] arr, String item)\\
		-Usage\\ \\
		This is a helper method that searches an arry for the specified item. If the item is found, the index is returned, else -1 is returned.
		\item Index of Item\\
		\$scope.checkCMUser = function()\\
		-Usage\\ \\
		This method checks whether the current user has permision to view the page, and redirects to the home page if they do not.
	\end{itemize}
	
\end{enumerate}
\section{Manage Inventory}
%-------------------------------inventory client controller
\subsection{inventory.client.controller}
 The inventory controller handles all the main functionality concerning inventory, such as adding an anventory item.
\begin{enumerate}
\item Declaration:\\angular.module('inventory').controller('InventoryController', ['\$scope', '\$http', '\$stateParams', '\$location', 'Authentication', 'Inventory',
	function(\$scope, \$http, \$stateParams, \$location, Authentication, Inventory)
\item Methods:
	\begin{itemize}
	\item Add form field inventory\\
  \$scope.addFormFieldInventory = function()\\ \\
  -Usage\\ 
  This method dynamically adds fields to the inventory page that are used to update the quantity of an inventory item. Each inventory item is displayed with the option to edit the quantity.
\item  Update inventory quantity\\
 \$scope.updateInventoryQuantity = function()\\ \\
 -Usage\\
 This method updates the quantity of an inventory item.
 \item Delete inventory item\\
  \$scope.deleteInventoryItem = function()\\ \\
  -Usage\\ 
  This method removes an inventory item from the database. It displays an error message when a user wants to remove an inventory item that is used by a menu item, in this case it displays an error message and does not remove the inventory item from the database.
  \item Load inventory items\\
   \$scope.loadInventoryItems = function()\\ \\
   -Usage\\
   The load inventory items searches for and returns all the inventory items in the database. It displays an error message when it could not load all the inventory items.
   \item Create inventory item\\ 
    \$scope.create = function(Boolean isValid)\\ \\
    -Usage\\
    This method creates a new inventory item and stores it in the database. It displays an error message if all the neccessary fields are not entered correctly. 
    \item Search inventory\\
     \$scope.searchInventory = function(Boolean isValid)\\ \\
     -Usage\\
     This method searches for and returns a specific inventory item. It displays an error message if the inventory item could not be found.
     \item Update inventory\\
      \$scope.updateInventory = function(Boolean isValid)\\ \\
      -Usage\\
      This method updates a specified inventory item. It displays an error message if all the neccessary fields were not entered correctly or if the item could not be updated.
      \item Check if cafeteria manager\\
       \$scope.checkCMUser = function()\\ \\
       -Usage\\
       This method performs a check to te confirm that the user has the cafeteria manager role. It prevents unauthorised users to perform actions that only the cafeteria manager is allowed to perform.
	\end{itemize}
\end{enumerate}
\subsection{inventory.server.controller}
 The inventory controller handles all the main functionality concerning inventory, such as adding an anventory item.
 
 \begin{enumerate}
 \item Methods:
 	\begin{itemize}
 	\item Load inventory items\\
 	exports.loadInventoryItems = function(JsonOBject req, JsonOBject res)\\ \\
 	-Usage\\
 	This method retrieves and returns all the inventory items in the databse. It is used to display all the inventory items where neccessary.
 	\item Search inventory\\
 	exports.searchInventory=function(JsonOBject req, JsonOBject res)\\ \\
 	-Usage\\
 	This method searches and returns a specific inventory item. It returns an error message if the specified item could not be found, or if the inventory item's name is empty.

 	\item Decrease inventory
 	exports.decreaseInventory = function(JsonOBject req, JsonOBject res) \\ \\
 	-Usage\\
 	This method decreases a specific inventory item with a certain amount. It returns an error message if the inventory item could not be found or if the inventory item could not be decreased.
 	\item Update inventory\\
 	exports.updateInventory = function(JsonOBject req,JsonOBject  res)\\ \\
 	-Usage\\
 	This method updates a specific inventory item. It returns an error message if the item to be updated was  not found, or if the item could not be updated.
 	\item Update inventory quantity
 	exports.updateInventoryQuantity=function(JsonOBject req, JsonOBject res)\\ \\
 	-Usage\\
 	This method updates the quantity of a specific inventory item. If the inventory item could not be found or updated it returns an error message.
 	\item Delte inventory item\\
 	exports.deleteInventoryItem = function(JsonOBject req, JsonOBject res)\\ \\
 
 	-Usage\\
 	This method deletes a specific inventory item. It returns an error messag if the item could not be found or deleted.
 	\end{itemize}
 \end{enumerate}
 
 %--------------PLACE ORDER----------------
\section{Place Order}
\subsection{orders.client.controller.js}
\begin{enumerate}
\item Declaration: angular.module('orders').controller('OrdersController', ['\$scope', '\$rootScope','\$http', '\$stateParams', '\$location', '\$cookies', 'Authentication', 'Orders',
function(\$scope, \$rootScope, \$http, \$stateParams, \$location, \$cookies, Authentication, Orders)  
\item Methods:
\begin{itemize}
\item Change item quantity \\ \$scope.quantityChange = function() 
\\ \\ Usage: Function to increase or decrease the number of items ordered. It is used when a user wants to order multiple of the same item. It then also increases or decreases the total price accordingly.
\item Change or add preferences \\ \$scope.prefChange = function() 
\\ \\ Usage: Function to add preferences. The user can specify how they prefer their order to be prepared.
\item Change the total \\ \$scope.subTotal = function() 
\\ \\ Usage: Function to calculate the total. This function calculates the total that will be displayed for the user at the bottom - so they can know how much their order is going to cost.
\item Place order \\ \$scope.placeOrder = function()
\\ \\ Usage: Function to place the order. If the user is not signed in, the function redirects them to the signin page. If the user is signed in, the function checks the order total against the user's available balance. If the user has enough funds in their account the order is placed. Otherwise a pop-up message tells the user they have insufficient funds in their account and that if they proceed with placing the order they will have to use cash - if the user agrees to use cash the order is placed otherwise nothing is done.
\item Remove item from plate \\ \$scope.removeFromPlate = function()
\\ \\ Usage: Function to remove an item from the plate. If the user decides they don't want an item anymore, they can remove it from the plate (before the order is placed).
\end{itemize}
\end{enumerate}
\subsection{orders.server.controller.js}
\begin{enumerate} 
\item Methods:
\begin{itemize}
\item Place order \\ exports.placeOrder = function(req, res) 
\\ \\ Usage: Function to place the order. It adds the order to the orders table if the user is successful in placing the order, otherwise it generates the appropriate error message.
\item Mark the order as ready \\ exports.markAsReady = function(req, res) 
\\ \\ Usage: Function to mark the order as ready. The cashier can mark the order as ready when the items are done being prepared and ready to be collected. This changes the status of the order to ready and sends the client a notification to come fetch their order.
\item Send Email \\ function sendEmail(uname, orderNum) 
\\ \\ Usage: Function to send the user an email. This function is called in markAsReady - it sends the user an email letting them know their order (with the given orderNumber) is ready to be collected.
\item Mark order as paid \\ exports.markAsPaid = function(req, res) 
\\ \\ Usage: Function to mark the order as paid and collected. This function marks the order as closed in the orders table and it removes it from the process orders page.
\item Mark order as collected \\ exports.markAsCollected = function(req, res) 
\\ \\ Usage: Function to mark the order as paid and collected. This function marks the order as closed in the orders table and it removes it from the process orders page. It also subtracts the total of the order from the user's limit because the client only collected the order and didn't pay. This can only be used when the user has sufficient funds in their account.
\item Get a list of orders \\ exports.getOrderList = function(req, res) 
\\ \\ Usage: Function to get a list of all the orders that are open and ready. This is used to display the orders that are still being processed and have not yet been collected on the process orders page (accessed by the cashier).
\end{itemize}
\end{enumerate}

\section{Other}
\subsection{tests.server.controller.js}
\begin{enumerate}
	\item Methods:
	\begin{itemize}
		\item Create \\ exports.create = function(JsonObject req, JsonObject res) 
		\\ \\ Usage: Function to create a generic test
		\item Read \\ exports.read = function(JsonObject req, JsonObject res) 
		\\ \\ Usage: Function to show the current test
		\item Delete \\ exports.delete = function(JsonObject req, JsonObject res) 
		\\ \\ Usage: Generic function to delete a test
		\item Update \\ exports.update = function(JsonObject req, JsonObject res) 
		\\ \\ Usage: Generic function to update a test 
		\item List \\ exports.list = function(JsonObject req,JsonObject res)
		\\ \\ Usage: Function to find all tests that are created and then populates a list
		\item Test by ID \\ exports.testByID = function(JsonObject req, JsonObject res, function next, String id)
		\\ \\ Usage: Function to find specific tests by ID
		\item Has authorization \\ exports.hasAuthorization = function(JsonObject req, JsonObject res, function next)
		\\ \\ Usage: Function to check if user is authorized to access specific functionality
	\end{itemize}
\end{enumerate}

\subsection{errors.server.controller.js}
\begin{enumerate}
	\item Methods:
	\begin{itemize}
		\item Get unique error message \\ var getUniqueErrorMessage = function(String err) \\ \\
		Usage: Function to supply error messages when employee ID chosen by user when signing up already exists in the database
		\item Get error message \\ exports.getErrorMessage = function(String err) 
		\\ \\ Usage: Function to supply generic error message when a problem occured in the system.
	\end{itemize}
\end{enumerate}

\subsection{core.server.controller.js}
\begin{enumerate}
	\item Methods:
	\begin{itemize}
		\item Get unique error message \\ exports.index = function(JsonObject req,JsonObject  res) 
		\\ \\ Usage: Function to get the indexes of the different users 
		\item Load canteen info \\ exports.loadCanteenInfo = function(JsonObject req,JsonObject  res)
		\\ \\ Usage: Function that is called when the home page is accessed to load the information about the canteen
	\end{itemize}
\end{enumerate}
\subsection{header.client.controller.js}
\begin{enumerate}
\item Declaration:\\ angular.module('core').controller('HeaderController', ['\$scope', '\$rootScope', '\$http', '\$location', '\$cookies','Authentication', 'Menus',
	function(\$scope, \$rootScope,\$http, \$location, \$cookies, Authentication, Menus)
	\item Methods:\\
	\begin{itemize}
	\item Load canteen info\\
	$scope.loadCanteenInfo = function()\\ \\
	Usage: This function loads the canteen name, if there is no name for the canteen it sets the cateen name to ``Canteen Name''.
	\item Sign out\\
	$scope.signout = function()\\ \\
	Usage: This method clears any orders of the user that might be stored in cookies when that user signs out.
	
	\end{itemize}
\end{enumerate}


\end{document}
